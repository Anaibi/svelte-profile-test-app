{#each profile.posts as post}
  <article class="post">
    {#if post.isReview}
      <Avatar user={post.review.user} isReview="true"/>
    {:else}
      <Avatar user={profile.user}/>
    {/if}

    <div class="content">
      {#if post.isReview}
        <PostTitle isReview="true" user={post.review.user} date={post.review.date}/>
      {:else}
        <PostTitle isSponsored={post.isSponsored} name={profile.user.name} date={post.date}/>
      {/if}

      {#if post.isSponsored}
        <SponsoredPost post={post}/>
      {:elseif post.isReview}
        <ReviewPost post={post} user={profile.user} rating={profile.details.rating}/>
      {:else}
        <Post post={post}/>
      {/if}

      <PostDetails details={post.details}/>
    </div>
  </article>
{/each}

<style>
  .post {
    display: flex;
    padding: 20px 35px;
    border-bottom: 1px solid #F5F5F5;
    color: #666666;
  }
  .content {
    flex: 1;
  }
</style>

<script>
  import Avatar from './Avatar.html';
  import PostTitle from './Posts/PostTitle.html';
  import SponsoredPost from './Posts/SponsoredPost.html';
  import ReviewPost from './Posts/ReviewPost.html';
  import Post from './Posts/Post.html';
  import PostDetails from './Posts/PostDetails.html';

  export default {
    components: {
      Avatar,
      PostTitle,
      SponsoredPost,
      ReviewPost,
      Post,
      PostDetails
    },
    methods: {
      loadPosts() {
        // TODO: load only x posts on create, and load rest on demand
      }
    },
    oncreate() {
      this.loadPosts();
    }
  }
</script>
